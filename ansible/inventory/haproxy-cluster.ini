# HAProxy + keepalived Cluster Inventory
# Customize this file with your actual hostnames and IP addresses
#
# Usage:
#   ansible-playbook -i inventory/haproxy-cluster.ini playbooks/haproxy-keepalived-deploy.yml
#
# Notes:
#   - For HA, deploy at least 2 nodes (1 primary, 1+ backup)
#   - Adjust ansible_host to match your network configuration
#   - Ensure SSH key authentication is configured for all nodes
#   - Primary node should have the highest keepalived priority

# ============================================
# HAProxy Primary Node (MASTER)
# ============================================
# The primary node will initially hold the Virtual IP
[haproxy_primary]
haproxy-lb-01 ansible_host=10.2.0.110 ansible_user=ansible haproxy_keepalived_priority=100

# ============================================
# HAProxy Backup Nodes (BACKUP)
# ============================================
# Backup nodes will take over if primary fails
# Lower priority values mean lower precedence
[haproxy_backup]
haproxy-lb-02 ansible_host=10.2.0.111 ansible_user=ansible haproxy_keepalived_priority=90
haproxy-lb-03 ansible_host=10.2.0.112 ansible_user=ansible haproxy_keepalived_priority=80

# ============================================
# Group Aggregation
# ============================================
[haproxy_cluster:children]
haproxy_primary
haproxy_backup

# ============================================
# Cluster-wide Variables
# ============================================
[haproxy_cluster:vars]
# Ansible connection settings
ansible_python_interpreter=/usr/bin/python3
ansible_ssh_private_key_file=~/.ssh/id_ed25519
ansible_ssh_common_args='-o StrictHostKeyChecking=no'

# Become settings
ansible_become=true
ansible_become_method=sudo
ansible_become_user=root

# Network configuration
haproxy_network_interface=eth0

# Virtual IP (ensure this IP is available on your network)
haproxy_virtual_ip=10.2.0.200

# ============================================
# Example: Simple 2-Node Cluster
# ============================================
# Uncomment below for a simple two-node setup
# [haproxy_primary]
# lb-primary ansible_host=192.168.1.100 ansible_user=ansible haproxy_keepalived_priority=100
#
# [haproxy_backup]
# lb-backup ansible_host=192.168.1.101 ansible_user=ansible haproxy_keepalived_priority=90
#
# [haproxy_cluster:children]
# haproxy_primary
# haproxy_backup

# ============================================
# Example: Single Node (No HA)
# ============================================
# For testing without HA (not recommended for production)
# [haproxy_primary]
# lb-single ansible_host=192.168.1.100 ansible_user=ansible haproxy_keepalived_priority=100
#
# [haproxy_backup]
# # Empty - no backup nodes
#
# [haproxy_cluster:children]
# haproxy_primary
# haproxy_backup

# ============================================
# Network Configuration Examples
# ============================================
# For nodes with multiple network interfaces:
# haproxy-lb-01 ansible_host=192.168.1.100 haproxy_network_interface=ens192

# For nodes with custom SSH ports:
# haproxy-lb-01 ansible_host=192.168.1.100 ansible_port=2222

# For nodes behind jump host:
# haproxy-lb-01 ansible_host=192.168.1.100 ansible_ssh_common_args='-o ProxyCommand="ssh -W %h:%p jump-host"'
