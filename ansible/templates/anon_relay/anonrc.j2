# Anyone Protocol Relay Configuration
# Generated by Ansible
# Documentation: https://docs.anyone.io/relay/

# ========================================
# User and Directory Settings
# ========================================
User anond
DataDirectory /var/lib/anon
ControlSocket /run/anon/control
CookieAuthentication 1
CookieAuthFile /run/anon/control.authcookie
CookieAuthFileGroupReadable 1

# ========================================
# Logging Configuration
# ========================================
Log {{ anon_relay_log_level }} file /etc/anon/notices.log
{% if anon_relay_syslog_enabled | default(false) %}
Log notice syslog
{% endif %}

# ========================================
# Relay Configuration
# ========================================
ORPort {{ anon_relay_or_port }}{% if anon_relay_ipv4_only | default(false) %} IPv4Only{% endif %}

{% if anon_relay_ipv4_only | default(false) %}
AddressDisableIPv6
{% endif %}

# Exit relay disabled by default (middle relay only)
{% if anon_relay_exit_policy | default(false) %}
ExitRelay 1
{% else %}
ExitRelay 0
{% endif %}

# ========================================
# Relay Identity
# ========================================
Nickname {{ anon_relay_nickname }}
ContactInfo {{ anon_relay_contact_info }}

{% if anon_relay_my_family is defined and anon_relay_my_family | length > 0 %}
# MyFamily declaration for relay operators running multiple relays
MyFamily {{ anon_relay_my_family | join(',') }}
{% endif %}

# ========================================
# Bandwidth Configuration
# ========================================
{% if anon_relay_bandwidth_rate is defined %}
RelayBandwidthRate {{ anon_relay_bandwidth_rate }} KBytes
{% endif %}
{% if anon_relay_bandwidth_burst is defined %}
RelayBandwidthBurst {{ anon_relay_bandwidth_burst }} KBytes
{% endif %}

# ========================================
# Terms and Conditions
# ========================================
AgreeToTerms 1

# ========================================
# Custom Configuration
# ========================================
{% if anon_relay_extra_config is defined %}
{% for config_line in anon_relay_extra_config %}
{{ config_line }}
{% endfor %}
{% endif %}
