# Longhorn Helm Chart Values
# Generated by Ansible for K3s cluster: {{ k3s_cluster_name }}

# ============================================
# Global Settings
# ============================================
image:
  longhorn:
    engine:
      repository: longhornio/longhorn-engine
      tag: {{ longhorn_version }}
    manager:
      repository: longhornio/longhorn-manager
      tag: {{ longhorn_version }}
    ui:
      repository: longhornio/longhorn-ui
      tag: {{ longhorn_version }}
    instanceManager:
      repository: longhornio/longhorn-instance-manager
      tag: {{ longhorn_version }}
    shareManager:
      repository: longhornio/longhorn-share-manager
      tag: {{ longhorn_version }}
    backingImageManager:
      repository: longhornio/backing-image-manager
      tag: {{ longhorn_version }}

# ============================================
# Service Configuration
# ============================================
service:
  ui:
    type: {{ longhorn_ui_service_type }}
  manager:
    type: ClusterIP

# ============================================
# Persistence Settings
# ============================================
persistence:
  defaultClass: {{ longhorn_default_storage_class }}
  defaultClassReplicaCount: {{ longhorn_default_replica_count }}
  reclaimPolicy: {{ longhorn_storage_retain_policy }}
  defaultDataPath: {{ longhorn_default_data_path }}

# ============================================
# Storage Class Configuration
# ============================================
defaultSettings:
  defaultReplicaCount: {{ longhorn_default_replica_count }}
  guaranteedInstanceManagerCPU: {{ longhorn_guaranteed_instance_manager_cpu }}
{% if longhorn_backup_target %}
  backupTarget: "{{ longhorn_backup_target }}"
{% endif %}
{% if longhorn_backup_target_secret %}
  backupTargetCredentialSecret: "{{ longhorn_backup_target_secret }}"
{% endif %}
  createDefaultDiskLabeledNodes: true
  defaultDataLocality: disabled
  replicaSoftAntiAffinity: false
  storageOverProvisioningPercentage: 200
  storageMinimalAvailablePercentage: 25
  upgradeChecker: {{ longhorn_enable_upgrade_checker | lower }}
  defaultLonghornStaticStorageClass: {{ longhorn_default_longhorn_static_storage_class }}

# ============================================
# Resource Limits
# ============================================
longhornManager:
  resources:
    requests:
      cpu: {{ longhorn_manager_cpu_request }}
      memory: {{ longhorn_manager_memory_request }}

longhornDriver:
  resources:
    requests:
      cpu: {{ longhorn_driver_cpu_request }}
      memory: {{ longhorn_driver_memory_request }}

longhornUI:
  resources:
    requests:
      cpu: {{ longhorn_ui_cpu_request }}
      memory: {{ longhorn_ui_memory_request }}

# ============================================
# Node Selection
# ============================================
{% if longhorn_node_selector %}
nodeSelector: {{ longhorn_node_selector | to_json }}
{% endif %}

{% if longhorn_tolerations %}
tolerations: {{ longhorn_tolerations | to_json }}
{% endif %}

# ============================================
# Ingress Configuration
# ============================================
ingress:
  enabled: {{ longhorn_ingress_enabled | lower }}
{% if longhorn_ingress_enabled %}
  host: {{ longhorn_ingress_host }}
  tls: {{ longhorn_ingress_tls_enabled | lower }}
  annotations: {{ longhorn_ingress_annotations | to_json }}
{% endif %}

# ============================================
# Advanced Settings
# ============================================
enablePSP: false

# Enable upgrade checker
enableUpgradeChecker: {{ longhorn_enable_upgrade_checker | lower }}

# ============================================
# Private Registry Configuration
# ============================================
# Uncomment if using private registry
# privateRegistry:
#   registryUrl: registry.example.com
#   registryUser: username
#   registryPasswd: password
